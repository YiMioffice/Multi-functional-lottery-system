# 使用说明文档

## 目录
1. [登录系统](#登录系统)
2. [创建转盘](#创建转盘)
3. [分享转盘](#分享转盘)
4. [管理转盘](#管理转盘)
5. [查看记录](#查看记录)
6. [管理员功能](#管理员功能)

---

## 登录系统

### 使用默认账户登录

1. 访问 [http://localhost:3000](http://localhost:3000)
2. 点击导航栏的"登录"按钮
3. 输入以下凭据：
   - **管理员账户**：
     - 邮箱：`admin@lottery.com`
     - 密码：`admin123456`
   - **普通用户账户**：
     - 邮箱：`user@lottery.com`
     - 密码：`user123456`

### 注册新账户

1. 在登录页面点击"没有账号？立即注册"
2. 填写：
   - 邮箱地址（必须是有效的邮箱格式）
   - 用户名（2-50个字符）
   - 密码（至少6个字符）
3. 点击"注册"按钮
4. 注册成功后自动登录

---

## 创建转盘

### 步骤一：进入管理面板

1. 登录后，点击"进入管理面板"或导航栏的"管理面板"
2. 点击"创建新转盘"按钮

### 步骤二：配置转盘信息

1. **基本信息**：
   - 转盘名称：例如"年会抽奖"、"活动礼品"
   - 描述（可选）：简单说明转盘用途

2. **选择抽奖类型**：
   - **转盘抽奖**：旋转大转盘，视觉效果好，适合现场活动
   - **暗箱抽奖**：盲抽模式，支持连抽，适合线上活动
   - **数字抽奖**：随机生成中奖数字，适合编号抽奖
   - **名单抽奖**：从名单中随机抽取，适合人员抽奖

### 步骤三：配置抽奖内容

根据选择的抽奖类型进行不同的配置：

#### A. 转盘抽奖 / 暗箱抽奖

1. **概率模式**：
   - ☑️ 均匀概率：所有奖品中奖概率相等
   - ☐ 加权概率：根据设置的权重决定中奖概率

2. **添加奖品**：
   - 点击"添加奖品"按钮
   - 为每个奖品设置：
     - **奖品名称**：例如"一等奖"、"iPhone 15"
     - **权重**（仅加权模式）：数值越大概率越高
     - **奖品图片**（可选）：点击"选择文件"上传图片
       - 支持格式：JPG、PNG、GIF、WEBP
       - 最大大小：5MB
   - 点击"删除"可以移除不需要的奖品
   - 至少需要一个奖品才能创建

#### B. 数字抽奖

1. 设置数字范围：
   - **最小值**：例如 1
   - **最大值**：例如 100
2. 系统将在这个范围内随机生成中奖数字

#### C. 名单抽奖

1. 添加参与名单：
   - **手动添加**：输入姓名后点击"添加"或按回车键
   - **批量上传**：点击"上传文件"按钮
     - 支持 .txt 或 .csv 文件
     - 每行一个姓名，或用逗号/分号分隔
     - 系统会自动去重
   - 点击每个人名旁的"删除"按钮可以移除
   - 至少需要一个参与人才能创建

### 步骤四：创建

点击"创建转盘"按钮完成创建。

---

## 分享转盘

### 获取分享链接

1. 在管理面板找到要分享的转盘
2. 点击"分享"按钮
3. 分享链接会自动复制到剪贴板
4. 将链接发送给参与者（微信、QQ、邮件等）

### 分享链接示例

```
http://localhost:3000/share/abc123defg
```

每个转盘都有唯一的分享码（如 `abc123defg`）

### 参与者如何使用

1. 参与者打开分享链接
2. 首次访问时输入自己的姓名
3. 点击"开始抽奖"按钮
4. 根据抽奖类型观看不同的抽奖效果：
   - **转盘抽奖**：观看转盘旋转动画
   - **暗箱抽奖**：观看盲盒抽取效果
   - **数字抽奖**：观看数字滚动效果
   - **名单抽奖**：观看名单随机选择效果
5. 查看抽奖结果

**注意**：
- 参与者无需注册账号
- 姓名会保存在浏览器，下次访问同一转盘时自动填充
- 每次抽奖都会记录到系统中
- 数字抽奖和名单抽奖每次都会生成新的随机结果

---

## 管理转盘

### 查看转盘列表

在管理面板可以看到所有创建的转盘，每个转盘显示：
- 转盘名称和描述
- 抽奖类型（转盘/暗箱/数字/名单）
- 奖品数量（转盘和暗箱类型）
- 抽奖次数
- 概率模式（转盘和暗箱类型）
- 创建时间

### 操作按钮

- **查看详情**：查看奖品配置和抽奖记录
- **分享**：复制分享链接
- **删除**：永久删除转盘（包括所有记录）

### 删除转盘

1. 点击转盘卡片上的"删除"按钮
2. 确认删除操作
3. 转盘及其所有数据将被永久删除

⚠️ **警告**：删除操作不可恢复，请谨慎操作！

---

## 查看记录

### 进入转盘详情页

1. 在管理面板点击转盘的"查看详情"按钮
2. 页面分为三个部分

### 奖品配置区

显示转盘的所有奖品：
- 奖品名称
- 奖品图片（如果有）
- 权重/概率（加权模式）
- 总权重统计

### 抽奖记录区

显示最近的抽奖记录（最多100条）：
- 参与者姓名
- 中奖奖品
- 抽奖时间

### 统计信息区

四个统计卡片：
1. **总抽奖次数**：累计抽奖的次数
2. **参与人数**：不重复的参与者数量
3. **奖品种类**：转盘包含的奖品数量
4. **分享码**：转盘的唯一分享码

### 复制分享链接

点击页面右上角的"复制分享链接"按钮，快速获取分享链接。

---

## 实用技巧

### 1. 选择合适的抽奖类型

**转盘抽奖**适合：
- 现场活动、年会
- 需要视觉效果和氛围
- 奖品种类不超过8个

**暗箱抽奖**适合：
- 线上活动
- 需要连续抽奖
- 简单快速的抽奖

**数字抽奖**适合：
- 已有编号的参与者
- 座位号抽奖
- 订单号抽奖

**名单抽奖**适合：
- 人员名单抽奖
- 团队成员抽取
- 批量导入名单

### 2. 设计合理的概率（转盘和暗箱）

**均匀模式**适合：
- 所有奖品价值相近
- 追求公平性
- 简单的抽奖活动

**加权模式**适合：
- 奖品价值差异大
- 需要控制成本
- 营销活动

权重设置示例（总和100）：
```
一等奖（iPhone）    权重: 5   (5%)
二等奖（平板）      权重: 15  (15%)
三等奖（耳机）      权重: 30  (30%)
谢谢参与            权重: 50  (50%)
```

### 3. 上传清晰的奖品图片

- 建议尺寸：500x500 像素
- 文件格式：PNG（支持透明背景）
- 图片内容：产品实物图或品牌Logo
- 文件大小：控制在500KB以内

### 4. 命名规范

- **转盘名称**：简洁明了，例如"2024年会抽奖"
- **奖品名称**：具体明确，例如"iPhone 15 Pro 256GB"
- **参与者姓名**：建议使用真实姓名便于核对

### 5. 批量导入名单技巧

创建 .txt 或 .csv 文件，每行一个姓名：
```
张三
李四
王五
```

或使用逗号/分号分隔：
```
张三,李四,王五;赵六
```

系统会自动去重，确保每个人只出现一次。

### 6. 数据导出

目前系统将数据存储在数据库中，如需导出：

```bash
# 导出数据库
sqlite3 prisma/dev.db .dump > backup.sql

# 查询抽奖记录
sqlite3 prisma/dev.db "SELECT * FROM DrawRecord;"
```

---

## 常见问题

### Q1: 忘记密码怎么办？

目前系统不支持密码找回功能。如果是默认账户，可以重新运行种子命令：

```bash
npm run seed
```

如果是自己注册的账户，请联系管理员或重新注册。

### Q2: 可以修改已创建的转盘吗？

目前版本不支持编辑功能，建议：
1. 删除旧转盘
2. 创建新转盘

或者等待后续版本更新。

### Q3: 分享链接失效了？

分享链接永久有效，除非：
- 转盘被删除
- 数据库被清空

### Q4: 可以限制抽奖次数吗？

目前版本不支持限制抽奖次数，每个人可以无限次抽奖。如有需要，可以在后续版本中添加此功能。

### Q5: 如何防止作弊？

建议措施：
1. 定期查看抽奖记录
2. 发现异常姓名及时沟通
3. 线下核实中奖者身份
4. 重要活动可以添加验证码功能（需二次开发）

---

## 管理员功能

### 进入管理后台

管理员用户在登录后，可以在管理面板页面看到"管理后台"按钮。

1. 使用管理员账户登录（`admin@lottery.com` / `admin123456`）
2. 进入管理面板
3. 点击右上角的"管理后台"按钮

### 管理后台概览

管理后台首页显示系统统计信息：
- **总用户数**：系统中注册的所有用户数量
- **总转盘数**：所有用户创建的转盘总数
- **总抽奖次数**：全系统累计抽奖次数
- **平均抽奖**：每个转盘的平均抽奖次数

### 用户管理

点击"用户管理"进入用户管理页面，可以：

1. **查看所有用户**：
   - 用户邮箱和用户名
   - 用户角色（管理员/普通用户）
   - 创建的转盘数量
   - 注册时间

2. **修改用户角色**：
   - 点击"更改角色"按钮
   - 选择新的角色（管理员/普通用户）
   - 确认修改
   - ⚠️ 不能修改自己的角色

3. **删除用户**：
   - 点击"删除"按钮
   - 确认删除操作
   - ⚠️ 不能删除自己的账户
   - ⚠️ 删除用户会级联删除该用户的所有转盘和记录

### 转盘管理

点击"转盘管理"进入转盘管理页面，可以：

1. **查看所有转盘**：
   - 转盘名称、描述、分享码
   - 创建者信息（用户名和邮箱）
   - 奖品数量
   - 抽奖次数
   - 创建时间

2. **查看转盘详情**：
   - 点击"查看详情"按钮
   - 查看奖品配置和抽奖记录
   - 与普通用户查看自己转盘的功能相同

3. **复制分享链接**：
   - 点击"复制链接"按钮
   - 分享链接会自动复制到剪贴板

4. **删除转盘**：
   - 点击"删除"按钮
   - 确认删除操作
   - ⚠️ 可以删除任何用户创建的转盘
   - ⚠️ 删除操作会永久删除转盘及其所有记录

### 权限说明

- 只有管理员账户可以访问管理后台
- 普通用户尝试访问管理后台会被重定向到管理面板
- 管理员拥有以下特殊权限：
  - 查看所有用户信息
  - 修改其他用户的角色
  - 删除其他用户（除了自己）
  - 查看所有用户创建的转盘
  - 删除任何转盘
  - 查看系统全局统计数据

### 安全建议

1. **妥善保管管理员账户**：
   - 建议修改默认管理员密码（需要数据库操作）
   - 不要将管理员账户信息分享给他人

2. **谨慎删除操作**：
   - 删除用户或转盘的操作不可恢复
   - 删除前请仔细确认

3. **定期检查**：
   - 定期查看用户列表，发现异常及时处理
   - 定期查看转盘列表，清理不必要的转盘

---

## 技术支持

如有问题，请：
1. 查看项目 README.md
2. 提交 GitHub Issue
3. 查看控制台错误信息

祝您使用愉快！🎉
